function renderHighlights(e){if(!e.length)return;const t=e.length,a=e[t-1];document.querySelector('#highlights [data-item="total_points"]').innerHTML=formatNumber(a.total),document.querySelector('#highlights [data-item="average_points"]').innerHTML=formatNumber(a.total/t,1),document.querySelector('#highlights [data-item="world_rank"]').innerHTML=formatNumber(a.rank),document.querySelector('#highlights [data-item="country_rank"]').innerHTML=formatNumber(a.country_rank),document.querySelector('#highlights [data-item="rank_change"]').innerHTML=formatDiff(a.rank_cng)}function renderCharts(e){if(!e.length)return;const t=e.slice(-60),a=t.map((e=>formatDate(e.date)));renderChart(document.getElementById("totalPointsChart"),{labels:a,data:t.map((e=>Number(e.total))),label:"Total Points",color:"#3b82f6",type:"line",reverseY:!1,isBar:!1,stepped:!1}),renderChart(document.getElementById("worldRankChart"),{labels:a,data:t.map((e=>Number(e.rank))),label:"World Rank",color:"#22c55e",type:"line",reverseY:!0,isBar:!1,stepped:!0}),renderChart(document.getElementById("dailyPointsChart"),{labels:a,data:t.map((e=>Number(e.daily))),label:"Daily Points",color:"#fbbf24",type:"bar",reverseY:!1,isBar:!0,stepped:!1}),renderChart(document.getElementById("countryRankChart"),{labels:a,data:t.map((e=>Number(e.country_rank))),label:"Country Rank",color:"#8b5cf6",type:"line",reverseY:!0,isBar:!1,stepped:!0})}async function main(){const e=["date","total","daily","rank","rank_cng","team_rank","team_cng","country_rank","country_cng"],t=["project","total","share","today","daily","weekly","monthly","rank","rank_cng_day","rank_cng_week","rank_cng_month","team_rank","country_rank"],a=["rank","cpu","cores","os","total","daily","weekly","monthly","avg"],[r,n,o]=await Promise.all([fetchTable("db/daily",e,"total"),fetchTable("db/projects",t),fetchTable("db/hosts",a)]);renderHighlights(r),renderCharts(r),renderTable("dailyTable",e,r,["Date","Total","Daily","Rank","Δ Rank","Team Rank","Δ Team","Country Rank","Δ Country"],((e,t)=>"date"===e?`<td>${formatDate(t)}</td>`:e.endsWith("_cng")?`<td>${formatDiff(t)}</td>`:`<td>${formatNumber(t)}</td>`),0,!0),renderTable("projectsTable",t,n,["Project","Total","Share","Today","Daily","Weekly","Monthly","Rank","Δ Day","Δ Week","Δ Month","Team Rank","Country Rank"],((e,t)=>"project"===e?`<td>${t.replace(/^"|"$/g,"")}</td>`:e.startsWith("rank_cng_")?`<td>${formatDiff(t)}</td>`:`<td>${formatNumber(t)}</td>`)),renderTable("hostsTable",a,o,["Rank","CPU","Cores","OS","Total","Daily","Weekly","Monthly","Ø"],((e,t)=>"cpu"===e||"os"===e?`<td>${t}</td>`:`<td>${formatNumber(t)}</td>`))}window.addEventListener("DOMContentLoaded",main);