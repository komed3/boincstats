function renderHighlights(t){if(!t.length)return;const e=t.length,a=t[e-1];document.querySelector('#highlights [data-item="total_points"]').innerHTML=formatNumber(a.total),document.querySelector('#highlights [data-item="average_points"]').innerHTML=formatNumber(a.total/e,1),document.querySelector('#highlights [data-item="world_rank"]').innerHTML=formatNumber(a.rank),document.querySelector('#highlights [data-item="country_rank"]').innerHTML=formatNumber(a.country_rank),document.querySelector('#highlights [data-item="rank_change"]').innerHTML=formatDiff(a.rank_cng)}function renderCharts(t){if(!t.length)return;const e=t.slice(-60),a=e.map((t=>formatDate(t.date)));Object.values(chartConfig).forEach((t=>{renderChart(document.getElementById(t.id),{labels:a,data:e.map((e=>Number(e[t.col]))),label:t.label,color:t.color,type:t.isBar?"bar":"line",reverseY:t.reverseY,isBar:t.isBar,stepped:t.stepped})}))}async function main(){const t=["date","total","daily","rank","rank_cng","team_rank","team_cng","country_rank","country_cng"],e=["project","total","share","today","daily","weekly","monthly","rank","rank_cng_day","rank_cng_week","rank_cng_month","team_rank","country_rank"],a=["rank","cpu","cores","os","total","daily","weekly","monthly","avg"],[r,n,o]=await Promise.all([fetchTable("db/daily",t,"total"),fetchTable("db/projects",e),fetchTable("db/hosts",a)]);renderHighlights(r),renderCharts(r),renderTable("dailyTable",t,r,["Date","Total","Daily","Rank","Δ Rank","Team Rank","Δ Team","Country Rank","Δ Country"],((t,e)=>"date"===t?`<td>${formatDate(e)}</td>`:t.endsWith("_cng")?`<td>${formatDiff(e)}</td>`:`<td>${formatNumber(e)}</td>`),0,!0),renderTable("projectsTable",e,n,["Project","Total","Share","Today","Daily","Weekly","Monthly","Rank","Δ Day","Δ Week","Δ Month","Team Rank","Country Rank"],((t,e)=>"project"===t?`<td>${e.replace(/^"|"$/g,"")}</td>`:t.startsWith("rank_cng_")?`<td>${formatDiff(e)}</td>`:`<td>${formatNumber(e)}</td>`)),renderTable("hostsTable",a,o,["Rank","CPU","Cores","OS","Total","Daily","Weekly","Monthly","Ø"],((t,e)=>"cpu"===t||"os"===t?`<td>${e}</td>`:`<td>${formatNumber(e)}</td>`))}window.addEventListener("DOMContentLoaded",main);