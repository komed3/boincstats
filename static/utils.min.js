function parseCSVLine(t){const e=[];let i=!1,r="";for(let o=0;o<t.length;++o){const a=t[o];if('"'===a)i=!i;else if(" "!==a||i)r+=a;else for(r.length&&(e.push(r),r="");" "===t[o+1];)++o}return r.length&&e.push(r),e}async function fetchTable(t,e,i){const r=await fetch(t);if(!r.ok)return[];return(await r.text()).split("\n").filter((t=>t.trim())).map(parseCSVLine).filter((t=>!i||"0"!==t[e.indexOf(i)]&&"0.0"!==t[e.indexOf(i)])).map((t=>{let i={};return e.forEach(((e,r)=>i[e]=t[r])),i}))}function formatNumber(t,e=0){return t&&!isNaN(t)?Number(t).toLocaleString("en-US",{minimumFractionDigits:e,maximumFractionDigits:e}):"–"}function formatCompact(t){return t=Number(t),isNaN(t)?"–":Math.abs(t)>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":Math.abs(t)>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"k":t.toString()}function formatDiff(t,e=0){if(isNaN(t)||null==t)return"–";const i=Number(t);return i>0?`<diff class="up">+${formatNumber(i,e)}</diff>`:i<0?`<diff class="down">${formatNumber(i,e)}</diff>`:'<diff class="equal">±0</diff>'}function formatDate(t){return t?new Date(t).toLocaleDateString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit"}):"–"}function renderTable(t,e,i,r,o,a=0,n=!1){let l=a,s=n;!function a(n){const d=`<tr>${r.map(((t,e)=>`<th data-idx="${e}" class="sortable ${l===e?"active":""}">${t}${l===e?s?" ▲":" ▼":""}</th>`)).join("")}</tr>`,c=n.map((t=>`<tr>${e.map(((e,i)=>o(e,t[e]))).join("")}</tr>`)).join("");document.getElementById(t).innerHTML=`<thead>${d}</thead><tbody>${c}</tbody>`,document.querySelectorAll(`#${t} th.sortable`).forEach((t=>{t.onclick=()=>{const r=Number(t.dataset.idx);l===r?s=!s:(l=r,s=!0);const o=e[l];a([...i].sort(((t,e)=>{let i=t[o],r=e[o];return isNaN(i)||isNaN(r)||(i=Number(i),r=Number(r)),(i>r?1:i<r?-1:0)*(s?1:-1)})))}}))}(i),document.querySelectorAll(`#${t} th.sortable`)[l].click()}function renderChart(t,e,i,r){const{labels:o,data:a,label:n,color:l,type:s,reverseY:d,isBar:c}=e;let f=i?.start??0,m=i?.end??o.length;const u=o.slice(f,m),b=a.slice(f,m);return Chart.defaults.font.family='"Archivo", sans-serif',new Chart(t.getContext("2d"),{type:s||(c?"bar":"line"),data:{labels:u,datasets:[{label:n,data:b,borderColor:l,backgroundColor:l+(c?"ff":"11"),fill:!c,stepped:!!e.stepped,...c?{borderRadius:3}:{pointRadius:0,borderWidth:3}}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0,mode:"index",intersect:!1,padding:{top:10,left:10,right:24,bottom:8},displayColors:!1,titleMarginBottom:0,titleFont:{size:13,weight:400},titleColor:"#222",bodyFont:{size:20,weight:600},bodyColor:l,borderColor:l,backgroundColor:"#fff",borderWidth:1,callbacks:{title:t=>t[0].label,label:t=>formatNumber(t.parsed.y,e.decimals||0)}}},elements:{point:{radius:0},line:{borderWidth:3}},scales:{x:{grid:{color:"#f3f4f6",lineWidth:1},ticks:{color:"#888",maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:6}},y:{grid:{color:"#f3f4f6",lineWidth:1},ticks:{color:"#888",maxTicksLimit:6,callback:t=>formatCompact(t)},reverse:!!d}},...r}})}